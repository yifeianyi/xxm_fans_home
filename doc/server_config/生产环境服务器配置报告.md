# XXM Fans Home ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨é…ç½®æŠ¥å‘Š

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-17  
**æœåŠ¡å™¨åœ°å€**: 47.92.253.0  
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0

---

## 1. ç³»ç»Ÿä¿¡æ¯æ¦‚è§ˆ

### 1.1 åŸºç¡€é…ç½®

| é¡¹ç›® | é…ç½®å€¼ |
|-----|-------|
| ä¸»æœºå | WebServer |
| æ“ä½œç³»ç»Ÿ | Ubuntu 24.04 LTS (Noble Numbat) |
| å†…æ ¸ç‰ˆæœ¬ | Linux 6.8.0-40-generic |
| æ¶æ„ | x86_64 |
| è¿è¡Œæ—¶é—´ | 16 å¤© 23 å°æ—¶ |

### 1.2 ç¡¬ä»¶èµ„æº

| èµ„æºç±»å‹ | é…ç½® |
|---------|------|
| CPU æ ¸å¿ƒæ•° | 2 æ ¸ |
| CPU å‹å· | Intel(R) Xeon(R) Platinum |
| å†…å­˜ | 1.6 GB |
| å†…å­˜ä½¿ç”¨ | 1.0 GB (62%) |
| å¯ç”¨å†…å­˜ | 672 MB |
| äº¤æ¢ç©ºé—´ | 0 B |
| ç£ç›˜æ€»å®¹é‡ | 40 GB |
| ç£ç›˜å·²ç”¨ | 18 GB (47%) |
| ç£ç›˜å¯ç”¨ | 20 GB |

### 1.3 ç³»ç»Ÿè´Ÿè½½

```
è´Ÿè½½å¹³å‡å€¼: 0.03, 0.01, 0.00
å½“å‰ç”¨æˆ·æ•°: 4
```

**è¯„ä¼°**: ç³»ç»Ÿè´Ÿè½½æä½ï¼Œèµ„æºä½¿ç”¨æ­£å¸¸ã€‚

---

## 2. æœåŠ¡çŠ¶æ€

### 2.1 Gunicorn (Django åç«¯)

| é¡¹ç›® | çŠ¶æ€ |
|-----|------|
| è¿è¡ŒçŠ¶æ€ | âœ… è¿è¡Œä¸­ |
| ç›‘å¬åœ°å€ | 0.0.0.0:8000 |
| å·¥ä½œè¿›ç¨‹æ•° | 3 ä¸ª |
| è™šæ‹Ÿç¯å¢ƒ | /home/yifeianyi/Desktop/venv |
| å¯åŠ¨ç”¨æˆ· | yifeianyi |

**å¯åŠ¨å‚æ•°**:
```bash
gunicorn --workers 3 \
  --bind 0.0.0.0:8000 \
  --pid /tmp/xxm-fans-gunicorn.pid \
  --access-logfile /home/yifeianyi/Desktop/xxm_fans_home/logs/gunicorn_access.log \
  --error-logfile /home/yifeianyi/Desktop/xxm_fans_home/logs/gunicorn_error.log \
  xxm_fans_home.wsgi:application
```

**æ—¥å¿—æ–‡ä»¶**:
- è®¿é—®æ—¥å¿—: 13M
- é”™è¯¯æ—¥å¿—: 11M

### 2.2 Nginx (Web æœåŠ¡å™¨)

| é¡¹ç›® | çŠ¶æ€ |
|-----|------|
| è¿è¡ŒçŠ¶æ€ | âœ… è¿è¡Œä¸­ |
| Master è¿›ç¨‹ | root ç”¨æˆ·è¿è¡Œ |
| Worker è¿›ç¨‹ | www-data ç”¨æˆ·è¿è¡Œ |
| HTTP ç«¯å£ | 80 |
| HTTPS ç«¯å£ | 443 |

**ç›‘å¬ç«¯å£**:
- 80: HTTP
- 443: HTTPS
- 8000: Gunicorn åç«¯
- 44321-44323: å…¶ä»–æœåŠ¡

### 2.3 é…ç½®çš„ç«™ç‚¹

| é…ç½®æ–‡ä»¶ | è¯´æ˜ |
|---------|------|
| xxm_home | ä¸»ç«™ç‚¹é…ç½® |
| bingjie-songlist.conf | å†°æ°æ­Œå•å­åŸŸå |
| leyou-songlist.conf | ä¹ä¼˜æ­Œå•å­åŸŸå |

---

## 3. åŸŸåå’Œ SSL é…ç½®

### 3.1 åŸŸåé…ç½®

| åŸŸå | ç”¨é€” | çŠ¶æ€ |
|-----|------|------|
| www.xxm8777.cn | ä¸»ç«™ | âœ… æ­£å¸¸ |
| admin.xxm8777.cn | ç®¡ç†åå° | âœ… æ­£å¸¸ |
| xxm8777.cn | è‡ªåŠ¨é‡å®šå‘åˆ° www | âœ… æ­£å¸¸ |
| bingjie.xxm8777.cn | å†°æ°æ­Œå• | âœ… æ­£å¸¸ |
| leyou.xxm8777.cn | ä¹ä¼˜æ­Œå• | âœ… æ­£å¸¸ |

### 3.2 SSL è¯ä¹¦

- **æä¾›å•†**: Let's Encrypt
- **è¯ä¹¦è·¯å¾„**: /etc/letsencrypt/live/xxm8777.cn-0001/
- **è‡ªåŠ¨ç»­æœŸ**: æ˜¯ (Certbot)
- **å®‰å…¨å¤´é…ç½®**:
  - Strict-Transport-Security
  - X-Content-Type-Options
  - X-Frame-Options
  - X-XSS-Protection

### 3.3 Nginx ä»£ç†é…ç½®

**Admin ç«™ç‚¹** (`admin.xxm8777.cn`):
- ç«¯å£: 443 SSL
- ä»£ç†åˆ°: 127.0.0.1:8000
- æœ€å¤§è¯·æ±‚ä½“: 10M
- é™æ€æ–‡ä»¶: `/static/` â†’ `staticfiles/`
- åª’ä½“æ–‡ä»¶: `/covers/` â†’ `media/covers/`

**ä¸»ç«™ç‚¹** (`www.xxm8777.cn`):
- å‰ç«¯ç›®å½•: `/repo/xxm_fans_frontend/dist`
- API ä»£ç†: `/api/` â†’ `127.0.0.1:8000`
- Admin ç¦æ­¢è®¿é—®

---

## 4. é¡¹ç›®é…ç½®

### 4.1 é¡¹ç›®è·¯å¾„

```
/home/yifeianyi/Desktop/xxm_fans_home/
â”œâ”€â”€ repo/
â”‚   â”œâ”€â”€ xxm_fans_backend/     # Django åç«¯
â”‚   â”œâ”€â”€ xxm_fans_frontend/    # React å‰ç«¯
â”‚   â””â”€â”€ TempSongListFrontend/ # Vue æ­Œå•æ¨¡æ¿
â”œâ”€â”€ media/                    # åª’ä½“æ–‡ä»¶
â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ scripts/                  # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ spider/                   # çˆ¬è™«è„šæœ¬
â”œâ”€â”€ data/                     # æ•°æ®æ–‡ä»¶
â””â”€â”€ env/                      # ç¯å¢ƒé…ç½®
```

### 4.2 åç«¯ç¯å¢ƒå˜é‡

```bash
DJANGO_DEBUG=False
DJANGO_SECRET_KEY=django-insecure-dev-key-for-local-testing-only
DJANGO_ALLOWED_HOSTS=localhost,127.0.0.1,172.27.171.134,www.xxm8777.cn,admin.xxm8777.cn,bingjie.xxm8777.cn,leyou.xxm8777.cn
SPOTIPY_CLIENT_ID=your_client_id_here
SPOTIPY_CLIENT_SECRET=your_client_secret_here
SPOTIPY_REDIRECT_URI=http://127.0.0.1:8080
```

**âš ï¸ æ³¨æ„**: Spotify é…ç½®ä½¿ç”¨çš„æ˜¯å ä½ç¬¦ï¼Œéœ€è¦æ›¿æ¢ä¸ºçœŸå®å€¼ã€‚

### 4.3 Python ç¯å¢ƒ

| é¡¹ç›® | ç‰ˆæœ¬/è·¯å¾„ |
|-----|----------|
| Python ç‰ˆæœ¬ | 3.12.3 |
| ç³»ç»Ÿ Python | /usr/bin/python3 |
| è™šæ‹Ÿç¯å¢ƒ | /home/yifeianyi/Desktop/venv |
| Django æ£€æŸ¥ | âœ… æ— é—®é¢˜ |

### 4.4 ç‰ˆæœ¬ä¿¡æ¯

**åç«¯** (æœ€è¿‘ 3 æ¬¡æäº¤):
- `c47b2a3` feat(çˆ¬è™«): ä¸º ViewsCrawler æ·»åŠ  tier å‚æ•°
- `e602dfd` feat(admin): å¢å¼ºå›¾ç‰‡ç®¡ç†åŠŸèƒ½
- `88e5500` æ·»åŠ ç›´æ’­è®°å½•æ·»åŠ åŠŸèƒ½

**å‰ç«¯** (æœ€è¿‘ 3 æ¬¡æäº¤):
- `4ef92d0` style(SongTable): PCç«¯è¡¨æ ¼å­—å·å¢å¤§
- `244f9d0` å®‰è£… Google Analytics
- `2ec1d74` å®‰è£…ç™¾åº¦ç»Ÿè®¡

---

## 5. å®šæ—¶ä»»åŠ¡é…ç½®

### 5.1 Crontab é…ç½®

```cron
# æ¯å°æ—¶è¿è¡Œä¸€æ¬¡Bç«™ç²‰ä¸æ•°çˆ¬è™«
0 */6 * * * /home/yifeianyi/Desktop/xxm_fans_home/scripts/bilibili_fans_count_cron.sh

# æ¯å°æ—¶è¿è¡Œåˆ†å±‚çˆ¬è™«
0 * * * * /home/yifeianyi/Desktop/xxm_fans_home/scripts/bilibili_tiered_cron.sh
```

### 5.2 çˆ¬è™«æ‰§è¡Œç»Ÿè®¡

| çˆ¬è™«ç±»å‹ | æ€»æ‰§è¡Œæ¬¡æ•° | æœ€è¿‘æ‰§è¡Œæ—¶é—´ |
|---------|----------|-------------|
| ç²‰ä¸æ•°çˆ¬è™« | 574 æ¬¡ | 2026-02-17 18:00:01 |
| åˆ†å±‚çˆ¬è™« | - | 2026-02-17 23:00 |

### 5.3 çˆ¬è™«è„šæœ¬ä½ç½®

- `/home/yifeianyi/Desktop/xxm_fans_home/scripts/bilibili_fans_count_cron.sh`
- `/home/yifeianyi/Desktop/xxm_fans_home/scripts/bilibili_tiered_cron.sh`
- `/home/yifeianyi/Desktop/xxm_fans_home/spider/run_tiered_crawler.py`

---

## 6. åª’ä½“æ–‡ä»¶å­˜å‚¨

### 6.1 å­˜å‚¨ç»Ÿè®¡

| ç›®å½• | å¤§å° | ç”¨é€” |
|-----|------|------|
| gallery | 8.7G | å›¾é›†å›¾ç‰‡ |
| cloud_picture | 493M | å¼¹å¹•äº‘å›¾ |
| covers | 266M | å°é¢å›¾ç‰‡ |
| data_analytics | 52M | æ•°æ®åˆ†æ |
| footprint | 18M | äºŒåˆ›å›¾ç‰‡ |
| songlist | 4.7M | æ­Œå•èµ„æº |
| **æ€»è®¡** | **~10G** | - |

### 6.2 Nginx åª’ä½“æ–‡ä»¶æ˜ å°„

```nginx
location /covers/ {
    alias /home/yifeianyi/Desktop/xxm_fans_home/media/covers/;
    expires 30d;
}

location /gallery/ {
    alias /home/yifeianyi/Desktop/xxm_fans_home/media/gallery/;
    expires 30d;
}
```

---

## 7. æ—¥å¿—ç®¡ç†

### 7.1 æ—¥å¿—æ–‡ä»¶æ¸…å•

| æ—¥å¿—æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|---------|------|------|
| gunicorn_access.log | 13M | Gunicorn è®¿é—®æ—¥å¿— |
| gunicorn_error.log | 11M | Gunicorn é”™è¯¯æ—¥å¿— |
| bilibili_fans_count.json | 269K | ç²‰ä¸æ•°çˆ¬è™«æ—¥å¿— |
| bilibili_tiered_crawler.json | 3B | åˆ†å±‚çˆ¬è™«æ—¥å¿— |
| bilibili_views_crawler.json | 19K | æŠ•ç¨¿çˆ¬è™«æ—¥å¿— |

### 7.2 æŠ¥å‘Šæ–‡ä»¶

- `report.html`
- `new_report.html`
- `2026-02-*.html` (å†å²æŠ¥å‘Š)

---

## 8. ç½‘ç»œçŠ¶æ€

### 8.1 è¿æ¥ç»Ÿè®¡

```
æ€»è¿æ¥æ•°: 268
TCP è¿æ¥: 33 (estab 10, closed 5, orphaned 0, timewait 5)
UDP è¿æ¥: 5
RAW è¿æ¥: 2
```

### 8.2 å¼€æ”¾ç«¯å£

| ç«¯å£ | æœåŠ¡ | ç›‘å¬åœ°å€ |
|-----|------|---------|
| 80 | Nginx | 0.0.0.0 |
| 443 | Nginx SSL | 0.0.0.0 |
| 8000 | Gunicorn | 0.0.0.0 |
| 44321-44323 | å…¶ä»– | 0.0.0.0 |

---

## 9. å®‰å…¨å’Œæƒé™

### 9.1 æ–‡ä»¶æƒé™

- é¡¹ç›®ç›®å½•: `yifeianyi:yifeianyi`
- Nginx é™æ€æ–‡ä»¶: `root:root` (éƒ¨åˆ†)
- æ—¥å¿—æ–‡ä»¶: æ··åˆæƒé™

### 9.2 å®‰å…¨å»ºè®®

1. **æ—¥å¿—æ–‡ä»¶æƒé™**: éƒ¨åˆ†æ—¥å¿—æ–‡ä»¶ä¸º root æ‰€æœ‰ï¼Œå»ºè®®ä½¿ç”¨ sudo æˆ–è°ƒæ•´æƒé™
2. **SSL è¯ä¹¦**: è¯ä¹¦æ­£å¸¸ï¼Œè‡ªåŠ¨ç»­æœŸ
3. **é˜²ç«å¢™**: éœ€è¦æ£€æŸ¥ UFW/iptables é…ç½®
4. **SSH è®¿é—®**: å·²é…ç½®å¯†é’¥ç™»å½•

---

## 10. è¿è¡ŒçŠ¶å†µè¯„ä¼°

### 10.1 æ•´ä½“çŠ¶æ€

| ç»„ä»¶ | çŠ¶æ€ | å¤‡æ³¨ |
|-----|------|------|
| ç³»ç»Ÿèµ„æº | ğŸŸ¢ è‰¯å¥½ | è´Ÿè½½ä½ï¼Œèµ„æºå……è¶³ |
| Gunicorn | ğŸŸ¢ æ­£å¸¸ | è¿è¡Œç¨³å®š |
| Nginx | ğŸŸ¢ æ­£å¸¸ | é…ç½®æ­£ç¡® |
| SSL è¯ä¹¦ | ğŸŸ¢ æ­£å¸¸ | Let's Encrypt |
| å®šæ—¶ä»»åŠ¡ | ğŸŸ¢ æ­£å¸¸ | çˆ¬è™«è¿è¡Œä¸­ |
| ç£ç›˜ç©ºé—´ | ğŸŸ¡ æ³¨æ„ | 47% ä½¿ç”¨ç‡ |

### 10.2 å»ºè®®ä¼˜åŒ–

1. **ç£ç›˜ç›‘æ§**: å½“å‰ 47% ä½¿ç”¨ç‡ï¼Œå»ºè®®è®¾ç½® 80% å‘Šè­¦
2. **æ—¥å¿—è½®è½¬**: Gunicorn æ—¥å¿—è¾ƒå¤§(13M+11M)ï¼Œå»ºè®®é…ç½® logrotate
3. **å†…å­˜ä¼˜åŒ–**: 1.6GB å†…å­˜å·²ä½¿ç”¨ 62%ï¼Œè€ƒè™‘ä¼˜åŒ–æˆ–å‡çº§
4. **Spotify é…ç½®**: éœ€è¦æ›¿æ¢ä¸ºçœŸå®çš„ API å¯†é’¥
5. **å¤‡ä»½ç­–ç•¥**: å»ºè®®å®šæœŸå¤‡ä»½æ•°æ®åº“å’Œåª’ä½“æ–‡ä»¶

---

## 11. å¿«é€Ÿå‚è€ƒå‘½ä»¤

### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```bash
# Gunicorn
ps aux | grep gunicorn

# Nginx
sudo systemctl status nginx

# ç«¯å£ç›‘å¬
ss -tlnp | grep -E '8000|80|443'
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# Gunicorn
 tail -f /home/yifeianyi/Desktop/xxm_fans_home/logs/gunicorn_error.log

# Nginx
sudo tail -f /var/log/nginx/error.log
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯ Gunicorn
kill -HUP $(cat /tmp/xxm-fans-gunicorn.pid)

# é‡å¯ Nginx
sudo systemctl reload nginx
```

### æ‰‹åŠ¨æ‰§è¡Œçˆ¬è™«
```bash
cd /home/yifeianyi/Desktop/xxm_fans_home
./scripts/bilibili_tiered_cron.sh
```

---

**æŠ¥å‘Šç»“æŸ**

*æœ¬æŠ¥å‘Šç”± AI Agent è‡ªåŠ¨ç”Ÿæˆï¼ŒåŸºäºæœåŠ¡å™¨å®æ—¶é‡‡é›†æ•°æ®ã€‚*
