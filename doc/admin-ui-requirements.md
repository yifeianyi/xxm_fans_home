# 小满虫之家后台管理UI功能需求文档

## 1. 文档概述

### 1.1 项目背景
本文档为"小满虫之家"（咻咻满粉丝站）设计一套现代化的React后台管理界面，作为Django自带admin后台的替代方案，提供更友好的用户体验和更丰富的交互功能。

### 1.2 目标用户
- 网站管理员（Admin）
- 内容编辑者（Editor）
- 数据维护人员（Data Maintainer）

### 1.3 技术栈
- **前端框架**: React 19 + TypeScript 5.8
- **构建工具**: Vite 6
- **UI组件库**: Ant Design 5.x 或 Shadcn/ui + Tailwind CSS
- **状态管理**: Zustand 或 React Query
- **图表库**: ECharts 或 Recharts
- **富文本编辑**: React-Quill 或 TipTap

---

## 2. 系统架构

### 2.1 前端目录结构
```
xxm_fans_admin/
├── src/
│   ├── components/          # 通用组件
│   │   ├── common/         # 基础UI组件
│   │   ├── forms/          # 表单组件
│   │   ├── tables/         # 表格组件
│   │   └── charts/         # 图表组件
│   ├── pages/              # 页面组件
│   │   ├── Login/          # 登录页
│   │   ├── Dashboard/      # 仪表盘
│   │   ├── Songs/          # 歌曲管理
│   │   ├── Livestream/     # 直播管理
│   │   ├── Gallery/        # 图集管理
│   │   ├── FansDIY/        # 粉丝二创
│   │   ├── Analytics/      # 数据分析
│   │   ├── Settings/       # 系统设置
│   │   └── User/           # 用户管理
│   ├── hooks/              # 自定义Hooks
│   ├── services/           # API服务层
│   ├── stores/             # 状态管理
│   ├── types/              # TypeScript类型定义
│   ├── utils/              # 工具函数
│   └── styles/             # 样式文件
├── public/                 # 静态资源
└── docs/                   # 组件文档
```

### 2.2 权限设计
采用RBAC（基于角色的访问控制）模型：

| 角色 | 权限范围 |
|------|----------|
| SuperAdmin | 所有权限，包括用户管理、系统配置 |
| Admin | 内容管理、数据维护、查看分析数据 |
| Editor | 歌曲/直播/图集的增删改查 |
| Viewer | 只读访问 |

---

## 3. 功能模块详细设计

### 3.1 登录与认证模块

#### 3.1.1 登录页面
- **路径**: `/login`
- **功能**:
  - 用户名/密码登录
  - 记住我选项
  - 登录状态保持（JWT Token）
  - 登录失败提示
  - 首次登录强制修改密码

#### 3.1.2 个人中心
- **路径**: `/profile`
- **功能**:
  - 修改个人信息
  - 修改密码
  - 查看登录历史
  - API Token管理（用于爬虫等外部调用）

---

### 3.2 仪表盘模块 (Dashboard)

#### 3.2.1 数据概览页
- **路径**: `/dashboard`
- **功能**:
  - **数据卡片**: 展示核心指标
    - 总歌曲数
    - 今日演唱记录数
    - 总直播场次
    - 粉丝二创作品数
    - B站粉丝数（实时）
    - 本周新增数据
  - **快捷操作**: 常用功能入口
    - 添加歌曲
    - 导入直播数据
    - 上传图集
    - 查看数据报告
  - **最近活动**: 操作日志展示
  - **待处理事项**: 待审核内容提醒

#### 3.2.2 实时数据监控
- **路径**: `/dashboard/realtime`
- **功能**:
  - 粉丝数变化曲线（24小时）
  - 最近投稿动态
  - 爬虫任务执行状态
  - 系统健康状态

---

### 3.3 歌曲管理模块 (Songs)

#### 3.3.1 歌曲列表
- **路径**: `/songs`
- **功能**:
  - **表格展示**: 
    - 列：ID、歌曲名、歌手、语言、曲风、演唱次数、首次演唱、最近演唱、操作
    - 支持列自定义显示/隐藏
    - 行内编辑（快速修改）
  - **搜索筛选**:
    - 关键词搜索（歌名、歌手）
    - 语言筛选
    - 曲风多选筛选
    - 标签筛选
    - 演唱次数范围筛选
  - **批量操作**:
    - 批量修改曲风
    - 批量修改标签
    - 批量删除
    - 导出Excel
  - **排序**: 多字段排序
  - **分页**: 支持自定义每页条数

#### 3.3.2 歌曲详情/编辑
- **路径**: `/songs/:id` 或 `/songs/new`
- **功能**:
  - **基本信息**:
    - 歌曲名称（必填）
    - 原唱歌手
    - 语言（下拉选择）
    - 曲风（多选，支持新建）
    - 标签（多选，支持新建）
  - **演唱记录管理**:
    - 时间线展示所有演唱记录
    - 添加/编辑/删除记录
    - 批量导入记录（Excel/CSV）
    - 从B站BV号自动导入
  - **统计数据**:
    - 演唱次数统计
    - 首次/最近演唱日期
  - **关联推荐**:
    - 相似歌曲推荐
    - 经常一起演唱的歌曲

#### 3.3.3 演唱记录管理
- **路径**: `/songs/records`
- **功能**:
  - 所有演唱记录的集中管理
  - 按日期范围筛选
  - 按歌曲筛选
  - 批量编辑日期
  - 批量关联到歌曲

#### 3.3.4 曲风管理
- **路径**: `/songs/styles`
- **功能**:
  - 曲风CRUD
  - 查看关联歌曲数
  - 合并曲风功能

#### 3.3.5 标签管理
- **路径**: `/songs/tags`
- **功能**:
  - 标签CRUD
  - 查看关联歌曲数
  - 合并标签功能
  - 标签颜色设置

#### 3.3.6 原创作品管理
- **路径**: `/songs/originals`
- **功能**:
  - 原创/翻唱作品列表
  - 关联歌曲
  - 上传音频文件
  - 歌词管理

---

### 3.4 直播管理模块 (Livestream)

#### 3.4.1 直播日历
- **路径**: `/livestream`
- **功能**:
  - **日历视图**:
    - 月视图/周视图切换
    - 有直播的日期标记
    - 点击日期查看详情
  - **列表视图**:
    - 表格展示所有直播记录
    - 快速搜索
  - **快捷操作**:
    - 添加直播记录
    - 编辑直播信息

#### 3.4.2 直播详情/编辑
- **路径**: `/livestream/:date` 或 `/livestream/new`
- **功能**:
  - **基本信息**:
    - 直播日期（必填）
    - 直播标题
    - 简介
    - BV号（支持多P）
    - 视频分段数
  - **时间信息**:
    - 开播时间
    - 下播时间
    - 时长（自动计算）
  - **统计数据**:
    - 观看人数
    - 弹幕数
  - **封面管理**:
    - 封面上传/选择
    - 从视频截图自动获取
  - **歌切管理**:
    - 关联当日演唱记录
    - 手动添加歌切时间点
  - **截图管理**:
    - LiveMoment图册关联
    - 批量上传截图
    - 截图预览
  - **弹幕云图**:
    - 上传/生成弹幕云图

#### 3.4.3 批量导入
- **路径**: `/livestream/import`
- **功能**:
  - 从Excel导入直播数据
  - 从B站批量导入（输入BV号列表）
  - 导入预览和确认
  - 导入历史记录

---

### 3.5 图集管理模块 (Gallery)

#### 3.5.1 图集列表
- **路径**: `/gallery`
- **功能**:
  - **树形展示**: 多级图集结构
  - **卡片视图**: 封面缩略图展示
  - **表格视图**: 详细信息列表
  - **搜索筛选**:
    - 按名称搜索
    - 按层级筛选
    - 按标签筛选

#### 3.5.2 图集详情/编辑
- **路径**: `/gallery/:id` 或 `/gallery/new`
- **功能**:
  - **基本信息**:
    - 图集ID（唯一标识）
    - 标题
    - 描述
    - 父图集（选择）
    - 层级（自动计算）
    - 文件夹路径
    - 标签
    - 排序
    - 启用状态
  - **图片管理**:
    - 拖拽上传图片
    - 批量上传
    - 图片排序
    - 图片删除
    - 批量删除
    - 图片预览（灯箱效果）
  - **封面设置**:
    - 从图片中选择封面
    - 上传自定义封面
  - **子图集管理**:
    - 快速创建子图集
    - 子图集排序

#### 3.5.3 批量同步
- **路径**: `/gallery/sync`
- **功能**:
  - 扫描文件夹自动同步
  - 预览同步结果
  - 冲突处理策略
  - 同步历史记录

---

### 3.6 粉丝二创管理模块 (FansDIY)

#### 3.6.1 合集管理
- **路径**: `/fansdiy/collections`
- **功能**:
  - 合集CRUD
  - 作品数量统计
  - 显示顺序调整
  - 批量操作

#### 3.6.2 作品管理
- **路径**: `/fansdiy/works`
- **功能**:
  - **列表展示**:
    - 表格展示所有作品
    - 封面缩略图
    - 快速预览
  - **搜索筛选**:
    - 按标题搜索
    - 按作者搜索
    - 按合集筛选
  - **编辑功能**:
    - 基本信息编辑
    - 封面上传/修改
    - 关联合集
    - 备注编辑
  - **批量导入**:
    - 从B站BV号导入
    - Excel导入

---

### 3.7 数据分析模块 (Analytics)

#### 3.7.1 数据概览
- **路径**: `/analytics`
- **功能**:
  - **粉丝数据**:
    - 粉丝数变化趋势图
    - 粉丝增长统计
    - 里程碑事件标记
  - **投稿数据**:
    - 投稿量统计
    - 播放量统计
    - 互动数据分析
  - **演唱数据**:
    - 歌曲演唱频次排行
    - 时间段演唱分布
    - 曲风分布饼图

#### 3.7.2 作品数据管理
- **路径**: `/analytics/works`
- **功能**:
  - B站投稿列表
  - 数据更新（手动触发爬虫）
  - 数据导出
  - 无效作品标记

#### 3.7.3 爬虫任务管理
- **路径**: `/analytics/crawler`
- **功能**:
  - 爬虫任务列表
  - 手动触发爬取
  - 爬取日志查看
  - 定时任务配置

---

### 3.8 网站设置模块 (Settings)

#### 3.8.1 基础设置
- **路径**: `/settings/general`
- **功能**:
  - **艺人信息**:
    - 艺人名称
    - 头像上传
    - 生日设置
    - 星座
    - 栖息地
    - 职业（多选）
    - 声线特色（多选）
  - **网站信息**:
    - 网站标题
    - Favicon上传
    - SEO描述
    - 关键词

#### 3.8.2 社交链接
- **路径**: `/settings/social`
- **功能**:
  - B站链接
  - 微博链接
  - 网易云音乐链接
  - YouTube链接
  - QQ音乐链接
  - 小红书链接
  - 抖音链接

#### 3.8.3 推荐管理
- **路径**: `/settings/recommendations`
- **功能**:
  - 推荐语CRUD
  - 关联歌曲选择
  - 激活状态管理

#### 3.8.4 里程碑管理
- **路径**: `/settings/milestones`
- **功能**:
  - 里程碑CRUD
  - 时间线展示
  - 排序调整

#### 3.8.5 CDN配置
- **路径**: `/settings/cdn`
- **功能**:
  - 主CDN配置
  - 备用CDN配置
  - 资源路径配置

---

### 3.9 用户管理模块 (Users)

#### 3.9.1 用户列表
- **路径**: `/users`
- **功能**:
  - 用户CRUD（仅限SuperAdmin）
  - 角色分配
  - 启用/禁用账户
  - 重置密码
  - 查看用户操作日志

#### 3.9.2 角色管理
- **路径**: `/users/roles`
- **功能**:
  - 角色CRUD
  - 权限配置
  - 查看角色成员

---

### 3.10 系统管理模块

#### 3.10.1 操作日志
- **路径**: `/system/logs`
- **功能**:
  - 操作记录列表
  - 按用户筛选
  - 按模块筛选
  - 按时间范围筛选
  - 导出日志

#### 3.10.2 数据备份
- **路径**: `/system/backup`
- **功能**:
  - 手动备份
  - 自动备份设置
  - 备份历史
  - 数据恢复

#### 3.10.3 缓存管理
- **路径**: `/system/cache`
- **功能**:
  - 查看缓存统计
  - 清除指定缓存
  - 清除全部缓存
  - 缓存预热

---

## 4. 通用组件设计

### 4.1 布局组件

#### 4.1.1 主布局 (MainLayout)
- **功能**:
  - 侧边栏导航
  - 顶部工具栏
  - 面包屑导航
  - 标签页（多页面切换）
  - 主题切换（亮色/暗色）

#### 4.1.2 侧边栏 (Sidebar)
- **功能**:
  - 菜单层级展示
  - 收起/展开
  - 权限控制（根据角色显示菜单）
  - 菜单搜索

### 4.2 表格组件

#### 4.2.1 数据表格 (DataTable)
- **功能**:
  - 列自定义显示
  - 列拖拽排序
  - 行选择（单选/多选）
  - 行内编辑
  - 虚拟滚动（大数据量）
  - 导出功能

### 4.3 表单组件

#### 4.3.1 动态表单 (DynamicForm)
- **功能**:
  - 根据配置动态渲染
  - 字段校验
  - 联动逻辑
  - 分步表单

#### 4.3.2 图片上传 (ImageUpload)
- **功能**:
  - 单图/多图上传
  - 拖拽上传
  - 裁剪功能
  - 压缩上传
  - 预览功能

#### 4.3.3 富文本编辑器 (RichEditor)
- **功能**:
  - 基础排版
  - 图片插入
  - 链接插入
  - 代码块
  - Markdown支持

---

## 5. 交互设计规范

### 5.1 反馈机制
- **操作成功**: Toast提示，绿色主题
- **操作失败**: Toast提示 + 详细错误信息，红色主题
- **加载状态**: Skeleton骨架屏 + Loading动画
- **确认操作**: 二次确认弹窗

### 5.2 表单校验
- 实时校验
- 失焦校验
- 提交前完整校验
- 错误信息清晰提示

### 5.3 数据刷新
- 自动刷新（可选，用于实时监控）
- 手动刷新按钮
- 下拉刷新（移动端适配）

---

## 6. 性能优化要求

### 6.1 加载优化
- 路由懒加载
- 组件懒加载
- 图片懒加载
- 虚拟滚动（大数据列表）

### 6.2 请求优化
- 请求防抖/节流
- 数据缓存
- 乐观更新
- 批量请求合并

### 6.3 缓存策略
- API响应缓存
- 表单草稿自动保存
- 用户偏好设置本地存储

---

## 7. 开发里程碑

### Phase 1: 基础框架 (2周)
- [ ] 项目初始化
- [ ] 登录认证模块
- [ ] 基础布局组件
- [ ] 权限系统

### Phase 2: 核心功能 (3周)
- [ ] 仪表盘
- [ ] 歌曲管理（含演唱记录）
- [ ] 直播管理

### Phase 3: 内容管理 (2周)
- [ ] 图集管理
- [ ] 粉丝二创管理

### Phase 4: 数据分析 (2周)
- [ ] 数据可视化
- [ ] 爬虫管理

### Phase 5: 系统完善 (1周)
- [ ] 网站设置
- [ ] 用户管理
- [ ] 系统管理

---

## 8. 附录

### 8.1 术语表
| 术语 | 说明 |
|------|------|
| BV号 | B站视频的唯一标识符 |
| 歌切 | 直播中的歌曲片段剪辑 |
| LiveMoment | 直播精彩时刻截图 |
| CRUD | 增删改查操作 |

### 8.2 相关文档
- [后台API设计文档](./admin-api-design.md)
- [前端开发规范](../repo/xxm_fans_frontend/AGENTS.md)
- [后端开发规范](../repo/xxm_fans_backend/IFLOW.md)
