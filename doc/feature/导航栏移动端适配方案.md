# 导航栏移动端适配方案

## 问题分析

### 当前状态
导航栏现有7个条目（包括中间头像）：
1. 满の歌声
2. 满の图册
3. 直播日历
4. 头像（中间）
5. 精选二创
6. 满の数据
7. 关于满满

### 问题
- **移动端显示不全**：在小屏幕设备上，导航项过多导致拥挤、换行或溢出
- **间距压缩**：现有 `gap-3 md:gap-6` 在移动端仍不足以容纳7个条目
- **用户体验下降**：导航项过小难以点击，或需要横向滚动影响体验

## 解决方案

### 方案选择：折叠式导航栏

**核心思路**：
- **桌面端**（≥768px）：保持顶部水平导航栏，显示所有导航项
- **移动端**（<768px）：只显示头像和菜单按钮，点击菜单按钮展开/收起两侧导航项

### 方案优势
1. **保持视觉一致性**：移动端仍使用顶部导航栏，风格统一
2. **简化界面**：收起时只显示头像和菜单，界面清爽
3. **灵活性高**：需要时展开，不需要时收起
4. **节省空间**：不占用额外页面空间
5. **保留品牌标识**：头像始终居中显示

## 技术实现方案

### 1. 导航栏结构调整

#### 桌面端（≥768px）
```
┌─────────────────────────────────────────────────────┐
│  满の歌声  满の图册  直播日历  [头像]  精选二创  满の数据  关于满满  │
└─────────────────────────────────────────────────────┘
```

#### 移动端 - 收起状态（<768px）
```
┌─────────────────────────────────────────────────────┐
│                   [☰]         [头像]         [☰]       │
└─────────────────────────────────────────────────────┘
```

#### 移动端 - 展开状态（<768px）
```
┌─────────────────────────────────────────────────────┐
│  满の歌声  满の图册  直播日历  [头像]  精选二创  满の数据  关于满满  │
└─────────────────────────────────────────────────────┘
```

### 2. 导航栏设计

#### 导航项分组
- **左侧导航**（头像左侧）：
  1. 满の歌声
  2. 满の图册
  3. 直播日历

- **右侧导航**（头像右侧）：
  4. 精选二创
  5. 满の数据
  6. 关于满满

#### 菜单按钮功能
- **左侧菜单按钮**：展开/收起左侧导航项
- **右侧菜单按钮**：展开/收起右侧导航项
- **点击头像**：返回首页

### 3. 组件实现

#### 3.1 修改 Navbar.tsx

**文件**: `presentation/components/layout/Navbar.tsx`

```tsx
import React, { useState } from 'react';
import * as ReactRouterDOM from 'react-router-dom';
import { Menu, X } from 'lucide-react';

const Navbar: React.FC = () => {
    const location = ReactRouterDOM.useLocation();
    const [isLeftMenuOpen, setIsLeftMenuOpen] = useState(false);
    const [isRightMenuOpen, setIsRightMenuOpen] = useState(false);

    const isSongs = location.pathname.startsWith('/songs');
    const isFans = location.pathname.startsWith('/fansDIY');
    const isGallery = location.pathname.startsWith('/gallery');
    const isLive = location.pathname.startsWith('/live');
    const isData = location.pathname.startsWith('/data');
    const isAbout = location.pathname.startsWith('/about');

    // 导航项配置
    const leftNavItems = [
        { path: '/songs', label: '满の歌声', active: isSongs },
        { path: '/gallery', label: '满の图册', active: isGallery },
        { path: '/live', label: '直播日历', active: isLive },
    ];

    const rightNavItems = [
        { path: '/fansDIY', label: '精选二创', active: isFans },
        { path: '/data', label: '满の数据', active: isData },
        { path: '/about', label: '关于满满', active: isAbout },
    ];

    return (
        <nav className="sticky top-0 z-50 w-full glass-card border-b border-white/50 px-4 py-2.5">
            <div className="flex items-center justify-center gap-3 md:gap-6">
                {/* 左侧菜单按钮（仅移动端） */}
                <button
                    onClick={() => setIsLeftMenuOpen(!isLeftMenuOpen)}
                    className="md:hidden p-2 rounded-full hover:bg-white/20 transition-colors text-[#8eb69b]"
                >
                    {isLeftMenuOpen ? <X size={20} /> : <Menu size={20} />}
                </button>

                {/* 左侧导航项 */}
                <div className={`flex gap-3 md:gap-6 transition-all duration-300 overflow-hidden ${isLeftMenuOpen ? 'md:flex' : 'hidden md:flex'}`}>
                    {leftNavItems.map((item) => (
                        <ReactRouterDOM.Link
                            key={item.path}
                            to={item.path}
                            onClick={() => setIsLeftMenuOpen(false)}
                            className={`relative py-1 flex flex-col items-center transition-all ${
                                item.active ? 'text-[#f8b195] scale-105' : 'text-[#8eb69b]'
                            }`}
                        >
                            <span className="text-xs md:text-sm font-black whitespace-nowrap px-2">
                                {item.label}
                            </span>
                            {item.active && (
                                <div className="absolute -bottom-1.5 h-1 w-6 bg-[#f8b195] rounded-full shadow-sm"></div>
                            )}
                        </ReactRouterDOM.Link>
                    ))}
                </div>

                {/* 头像（始终显示） */}
                <ReactRouterDOM.Link
                    to="/"
                    className="flex items-center gap-2 shrink-0 px-2"
                    onClick={() => {
                        setIsLeftMenuOpen(false);
                        setIsRightMenuOpen(false);
                    }}
                >
                    <div className="w-8 h-8 md:w-10 md:h-10 rounded-[1.2rem] overflow-hidden border-2 border-white shadow-sm transition-transform hover:scale-110">
                        <img src="/favicon-32x32.png" alt="咻咻满头像" className="w-full h-full object-cover" />
                    </div>
                </ReactRouterDOM.Link>

                {/* 右侧导航项 */}
                <div className={`flex gap-3 md:gap-6 transition-all duration-300 overflow-hidden ${isRightMenuOpen ? 'md:flex' : 'hidden md:flex'}`}>
                    {rightNavItems.map((item) => (
                        <ReactRouterDOM.Link
                            key={item.path}
                            to={item.path}
                            onClick={() => setIsRightMenuOpen(false)}
                            className={`relative py-1 flex flex-col items-center transition-all ${
                                item.active ? 'text-[#f8b195] scale-105' : 'text-[#8eb69b]'
                            }`}
                        >
                            <span className="text-xs md:text-sm font-black whitespace-nowrap px-2">
                                {item.label}
                            </span>
                            {item.active && (
                                <div className="absolute -bottom-1.5 h-1 w-6 bg-[#f8b195] rounded-full shadow-sm"></div>
                            )}
                        </ReactRouterDOM.Link>
                    ))}
                </div>

                {/* 右侧菜单按钮（仅移动端） */}
                <button
                    onClick={() => setIsRightMenuOpen(!isRightMenuOpen)}
                    className="md:hidden p-2 rounded-full hover:bg-white/20 transition-colors text-[#8eb69b]"
                >
                    {isRightMenuOpen ? <X size={20} /> : <Menu size={20} />}
                </button>
            </div>
        </nav>
    );
};

export default Navbar;
```

### 4. 样式优化

#### 导航栏样式要点
- **过渡动画**: 使用 `transition-all duration-300` 实现平滑展开/收起
- **溢出处理**: 使用 `overflow-hidden` 防止内容溢出
- **响应式控制**: `hidden md:flex` 控制移动端和桌面端显示
- **点击反馈**: 按钮添加 hover 效果

#### 图标选择
使用 Lucide React 图标库：
- **菜单按钮**: `Menu` (收起状态)
- **关闭按钮**: `X` (展开状态)

### 5. 交互逻辑

#### 状态管理
- `isLeftMenuOpen`: 控制左侧导航项展开/收起
- `isRightMenuOpen`: 控制右侧导航项展开/收起

#### 点击行为
1. **点击左侧菜单按钮**：切换左侧导航项显示状态
2. **点击右侧菜单按钮**：切换右侧导航项显示状态
3. **点击导航项**：跳转并关闭对应侧菜单
4. **点击头像**：返回首页并关闭所有菜单

#### 路由变化处理
```tsx
// 可选：监听路由变化，自动关闭菜单
useEffect(() => {
    setIsLeftMenuOpen(false);
    setIsRightMenuOpen(false);
}, [location.pathname]);
```

## 用户体验优化

### 1. 视觉反馈
- **菜单按钮状态**: 展开时显示关闭图标 (X)，收起时显示菜单图标 (☰)
- **导航项过渡**: 展开/收起时平滑过渡，无突兀感
- **激活状态**: 保持原有的高亮和下划线指示

### 2. 操作便捷性
- **独立控制**: 左右两侧可独立展开/收起
- **自动关闭**: 点击导航项后自动关闭菜单
- **头像居中**: 头像始终居中，作为视觉锚点

### 3. 内容适配
- **桌面端**: 所有导航项始终显示，无需额外操作
- **移动端**: 默认收起，需要时展开，减少界面 clutter

### 4. 可访问性
- **触摸目标**: 菜单按钮至少 44×44px
- **键盘导航**: 支持键盘操作（Tab 键切换，Enter 键激活）
- **屏幕阅读器**: 添加适当的 ARIA 标签

## 实施步骤

### 阶段一：基础实现
1. ✅ 修改 `Navbar.tsx` 添加折叠功能
2. ✅ 实现左右菜单状态管理
3. ✅ 添加菜单按钮和图标
4. ✅ 实现展开/收起逻辑
5. ✅ 测试基础功能

### 阶段二：样式优化
1. 调整过渡动画效果
2. 优化菜单按钮样式
3. 确保与主题色一致
4. 添加 hover 和 active 状态

### 阶段三：交互优化
1. 添加路由变化监听
2. 优化点击行为
3. 添加键盘导航支持
4. 优化动画性能

### 阶段四：兼容性测试
1. 测试不同屏幕尺寸（375px, 414px, 768px）
2. 测试横屏模式
3. 测试各页面导航
4. 测试快速展开/收起

### 阶段五：用户验证
1. 验证移动端操作体验
2. 检查导航清晰度
3. 测试展开/收起性能
4. 收集反馈并优化

## 备选方案

### 方案二：单一汉堡菜单
- **优点**: 实现简单
- **缺点**: 失去品牌标识（头像），需要额外空间显示菜单

### 方案三：横向滚动
- **优点**: 保持当前结构
- **缺点**: 不够直观，用户可能不知道有更多选项

### 方案四：底部导航栏
- **优点**: 符合移动端习惯
- **缺点**: 改变现有布局，需要大幅调整

## 技术约束

### Tailwind CSS 类
- **断点**: `md` (≥768px)
- **显示控制**: `hidden md:flex`, `md:hidden`
- **过渡**: `transition-all duration-300`
- **溢出**: `overflow-hidden`

### React Hooks
- `useState`: 管理菜单展开/收起状态
- `useEffect`: 监听路由变化（可选）

### 主题色
- 激活色: `#f8b195` (蜜桃粉)
- 默认色: `#8eb69b` (豆沙绿)
- 背景: 玻璃拟态效果

## 总结

采用**折叠式导航栏**方案，通过以下方式解决移动端导航栏显示不全问题：
- **桌面端**：保持现有顶部水平导航，所有导航项始终显示
- **移动端**：默认只显示头像和菜单按钮，点击菜单按钮展开/收起对应侧导航项
- **独立控制**：左右两侧可独立展开/收起，灵活度高
- **视觉一致性**：保持顶部导航栏布局，风格统一
- **品牌标识**：头像始终居中显示，强化品牌认知

该方案在保持现有设计风格的同时，通过折叠机制有效解决了移动端空间受限的问题，用户体验友好且实施难度适中。